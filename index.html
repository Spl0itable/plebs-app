<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plebs - Decentralized Video Platform</title>
    <meta name="description"
        content="Plebs is a censorship-resistant, decentralized video platform powered by the Nostr social protocol">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Watch Videos on Nostr with Plebs">
    <meta property="og:description"
        content="Plebs is a censorship-resistant, decentralized video platform powered by the Nostr social protocol">
    <meta property="og:image" content="https://plebs.app/images/plebs-og.png">
    <meta property="og:url" content="https://plebs.app">
    <meta property="og:type" content="website">
    <link rel="icon" href="./images/plebs-icon.png" type="image/png">
    <link rel="canonical" href="https://plebs.app/">
    <meta name="theme-color" content="#BF40BF">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Plebs">
    <link rel="apple-touch-icon" href="./images/plebs-icon.png">

    <!-- Plebs Styling -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <div class="header-content">
            <a href="#/" class="logo">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83-.25.9-.83 1.48-1.73 1.73-.47.13-1.33.22-2.65.28-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44-.9-.25-1.48-.83-1.73-1.73-.13-.47-.22-1.1-.28-1.9-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83.25-.9.83-1.48 1.73-1.73.47-.13 1.33-.22 2.65-.28 1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44.9.25 1.48.83 1.73 1.73z" />
                </svg>
                Plebs
            </a>

            <div class="search-bar">
                <input type="text" placeholder="Search videos..." id="searchInput">
                <button onclick="searchVideos()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
            </div>

            <div class="header-actions">
                <button class="menu-toggle" onclick="toggleSidebar()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
                    </svg>
                </button>

                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="theme-icon-light">
                        <path
                            d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z" />
                    </svg>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="theme-icon-dark"
                        style="display: none;">
                        <path
                            d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z" />
                    </svg>
                </button>

                <button class="notification-toggle" onclick="loadNotifications()" title="Notifications"
                    id="notificationBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9" />
                        <path d="M13.73 21a2 2 0 0 1-3.46 0" />
                    </svg>
                </button>

                <button class="notification-toggle" onclick="showSettingsModal()" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z" />
                    </svg>
                </button>

                <button class="upload-btn" onclick="showUploadModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                        style="display: inline-block; vertical-align: middle;">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z" />
                    </svg>
                    <span class="btn-text">Upload</span>
                </button>

                <!-- User Menu -->
                <div class="user-menu" id="userMenu">
                    <button class="user-btn" id="userBtn" onclick="toggleUserMenu()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="userIcon">
                            <path
                                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                        </svg>
                        <img id="userAvatar" src="" alt="User" style="display: none;">
                    </button>
                    <div class="user-dropdown" id="userDropdown">
                        <button onclick="handleLogout()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" />
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <div class="container">
        <aside class="sidebar" id="sidebar">
            <a href="#/" class="sidebar-item active">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                </svg>
                Home
            </a>
            <a href="#/subscriptions" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M20 8H4V6h16v2zm-2-6H6v2h12V2zm4 10v8c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2v-8c0-1.1.9-2 2-2h16c1.1 0 2 .9 2 2zm-6 4l-6-3.27v6.53L16 16z" />
                </svg>
                Subscriptions
            </a>
            <a href="#/my-videos" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M3 5v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.11 0-2 .9-2 2zm12 4c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3zm-9 8c0-2 4-3.1 6-3.1s6 1.1 6 3.1v1H6v-1z" />
                </svg>
                My Videos
            </a>
            <a href="#/liked" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" />
                </svg>
                Liked
            </a>
            <hr style="border: none; border-top: 1px solid var(--border); margin: 1rem 0;">
            <div style="padding: 0 1rem; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">TAGS
            </div>
            <a href="#/tag/bitcoin" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M17.06 11.57c.59-.69.94-1.59.94-2.57 0-1.86-1.27-3.43-3-3.87V3h-2v2h-2V3H9v2H6v2h1c.55 0 1 .45 1 1v8c0 .55-.45 1-1 1H6v2h3v2h2v-2h2v2h2v-2.13c2.39-.54 4-2.65 4-5.07 0-1.37-.53-2.62-1.4-3.55M10 7h4c1.1 0 2 .9 2 2s-.9 2-2 2h-4V7zm5 10h-5v-4h5c1.1 0 2 .9 2 2s-.9 2-2 2z" />
                </svg>
                Bitcoin
            </a>
            <a href="#/tag/nostr" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M7 2v11h3v9l7-12h-4l4-8z" />
                </svg>
                Nostr
            </a>
            <a href="#/tag/tech" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z" />
                </svg>
                Technology
            </a>
            <a href="#/tag/gaming" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M15 7.5V2H9v5.5l3 3 3-3zM7.5 9H2v6h5.5l3-3-3-3zM9 16.5V22h6v-5.5l-3-3-3 3zM16.5 9l-3 3 3 3H22V9h-5.5z" />
                </svg>
                Gaming
            </a>
            <a href="#/tag/tutorial" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                </svg>
                Tutorials
            </a>
            <a href="#/tag/vlog" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z" />
                </svg>
                Vlogs
            </a>
            <a href="#/tag/music" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z" />
                </svg>
                Music
            </a>
            <a href="#/tag/nsfw" class="sidebar-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"
                    style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z" />
                </svg>
                NSFW
            </a>

            <div
                style="margin-top: auto; padding: 1rem; text-align: center; font-size: 0.875rem; color: var(--text-secondary);">
                <a class="github-button" href="https://github.com/Spl0itable/plebs-app"
                    data-color-scheme="no-preference: light; light: light; dark: dark;" data-size="large"
                    aria-label="Follow @Spl0itable on GitHub">GitHub</a><br />
                Made with ♥ by <a
                    href="https://nostr.band/npub16jdfqgazrkapk0yrqm9rdxlnys7ck39c7zmdzxtxqlmmpxg04r0sd733sv"
                    target="_blank" style="color: var(--accent); text-decoration: none;">Luxas</a>
            </div>
        </aside>

        <main class="main-content" id="mainContent">
            <div class="spinner"></div>
        </main>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content login-modal">
            <div class="modal-header">
                <h2>Login with Nostr</h2>
                <button class="close-modal" onclick="hideLoginModal()">&times;</button>
            </div>

            <div class="login-options">
                <button class="login-option" onclick="loginWithExtension()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                    </svg>
                    <span>Login with Extension</span>
                    <p>Use Alby, nos2x, or other Nostr browser extensions</p>
                </button>

                <button class="login-option" onclick="showConnectModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                    </svg>
                    <span>Nostr Connect</span>
                    <p>Connect with remote signers like Amber, nsec.app</p>
                </button>

                <button class="login-option" onclick="showPrivateKeyModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z" />
                    </svg>
                    <span>Private Key</span>
                    <p>Enter your nsec or hex private key (local only)</p>
                </button>

                <button class="login-option" onclick="showReadOnlyModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" />
                    </svg>
                    <span>Read-Only</span>
                    <p>View content with your public key (npub)</p>
                </button>

                <div class="login-divider">
                    <span>New to Nostr?</span>
                </div>

                <button class="login-option signup" onclick="showSignupModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                    </svg>
                    <span>Create Account</span>
                    <p>Get started with a new Nostr identity</p>
                </button>
            </div>
        </div>
    </div>

    <!-- Connect Modal -->
    <div class="modal" id="connectModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Connect with Nostr</h2>
                <button class="close-modal" onclick="hideConnectModal()">&times;</button>
            </div>

            <div class="connect-steps">
                <div class="connect-step">
                    <h3>Option 1: Use this connection string</h3>
                    <p style="margin-bottom: 0.5rem; color: var(--text-secondary);">
                        Copy and paste this into any NIP-46 compatible app (nsec.app, Amber, etc.)
                    </p>
                    <textarea id="nostrConnectURI" readonly style="width: 100%; padding: 0.75rem; margin: 0.5rem 0; font-size: 0.875rem; 
                                 height: 100px; resize: none; background: var(--bg-primary); 
                                 color: var(--text-primary); border: 1px solid var(--border); 
                                 border-radius: 8px; word-break: break-all;"></textarea>
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <button class="copy-btn" onclick="copyNostrConnectURI()">Copy Connection String</button>
                        <button class="copy-btn" onclick="toggleQRDisplay()" style="background: var(--bg-secondary);">
                            Show QR Code
                        </button>
                    </div>

                    <!-- Connection status for connection string -->
                    <div id="connectStringStatus" style="display: none; padding: 0.75rem; 
                                                    background: var(--bg-primary); 
                                                    border: 1px solid var(--accent); 
                                                    border-radius: 8px; margin: 1rem 0;
                                                    color: var(--accent); text-align: center;">
                        <div class="spinner"></div>
                        <span>Listening for connection...</span>
                    </div>

                    <div id="qrCodeSection" style="display: none; margin: 1rem 0;">
                        <div id="nostrConnectQR" style="background: white; padding: 1rem; 
                                                     border-radius: 8px; display: inline-block;"></div>
                        <!-- Connection status for QR code -->
                        <div id="qrConnectionStatus" style="display: none; padding: 0.75rem; 
                                                        background: var(--bg-primary); 
                                                        border: 1px solid var(--accent); 
                                                        border-radius: 8px; margin-top: 1rem;
                                                        color: var(--accent); text-align: center;">
                            <div class="spinner"></div>
                            <span>Listening for connection...</span>
                        </div>
                    </div>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <div class="connect-step">
                    <h3>Option 2: Paste a bunker URL</h3>
                    <p style="margin-bottom: 0.5rem; color: var(--text-secondary);">
                        If you already have a bunker:// URL from a remote signer
                    </p>
                    <input type="text" id="bunkerUrl" placeholder="bunker://..." class="form-control">
                    <button class="upload-btn" onclick="connectWithBunker()" style="margin-top: 1rem;">
                        Connect with Bunker
                    </button>
                </div>

                <div class="connect-step" style="background: var(--bg-primary); padding: 1rem; 
                                           border-radius: 8px; margin-top: 1rem;">
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 0;">
                        <strong>Popular NIP-46 signers:</strong><br>
                        • <a href="https://nsec.app" target="_blank" style="color: var(--accent);">nsec.app</a> -
                        Web-based signer<br>
                        • <a href="https://amber.app" target="_blank" style="color: var(--accent);">Amber</a> - Android
                        app<br>
                        • <a href="https://highlighter.com/settings/keys/device" target="_blank"
                            style="color: var(--accent);">Highlighter</a> - Built-in signer
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Private Key Modal -->
    <div class="modal" id="privateKeyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Login with Private Key</h2>
                <button class="close-modal" onclick="hidePrivateKeyModal()">&times;</button>
            </div>

            <div class="key-warning">
                <h3>⚠️ Security Warning</h3>
                <p>Your private key will be stored locally in your browser. For better security, consider using a
                    browser extension or Nostr Connect instead.</p>
            </div>

            <div class="form-group">
                <label>Private Key (nsec or hex)</label>
                <input type="password" id="privateKeyInput" placeholder="nsec1..." class="form-control">
                <div class="key-toggle">
                    <input type="checkbox" id="showKey" onchange="toggleKeyVisibility()">
                    <label for="showKey">Show key</label>
                </div>
            </div>

            <button class="upload-btn" onclick="loginWithPrivateKey()" style="margin-top: 1rem;">
                Login
            </button>
        </div>
    </div>

    <!-- Read-Only Modal -->
    <div class="modal" id="readOnlyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Read-Only Access</h2>
                <button class="close-modal" onclick="hideReadOnlyModal()">&times;</button>
            </div>

            <div class="form-group">
                <label>Public Key (npub or hex)</label>
                <input type="text" id="publicKeyInput" placeholder="npub1..." class="form-control">
                <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                    You can view content but won't be able to post, like, or comment
                </p>
            </div>

            <button class="upload-btn" onclick="loginReadOnly()" style="margin-top: 1rem;">
                Continue
            </button>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create Nostr Account</h2>
                <button class="close-modal" onclick="hideSignupModal()">&times;</button>
            </div>

            <div class="form-group">
                <label>Username</label>
                <input type="text" id="signupUsername" placeholder="Choose a username" class="form-control">
            </div>

            <div class="form-group">
                <label>About (optional)</label>
                <textarea id="signupAbout" placeholder="Tell us about yourself" class="form-control"
                    rows="3"></textarea>
            </div>

            <div class="profile-preview">
                <div class="profile-preview-avatar" id="previewAvatar">
                    <span id="avatarInitial">?</span>
                </div>
                <div class="profile-preview-info">
                    <h3 id="previewName">Your Username</h3>
                    <p id="previewAbout">Your bio will appear here</p>
                </div>
            </div>

            <button class="upload-btn" onclick="createAccount()" style="margin-top: 1rem;">
                Create Account
            </button>

            <div class="key-warning" style="margin-top: 1rem; display: none;" id="signupSuccess">
                <h3>✅ Account Created!</h3>
                <p>Your private key (save this securely):</p>
                <div
                    style="background: var(--bg-primary); padding: 0.5rem; border-radius: 4px; margin: 0.5rem 0; word-break: break-all; font-family: monospace;">
                    <span id="generatedNsec"></span>
                </div>
                <button class="copy-btn" onclick="copyGeneratedKey()">Copy Key</button>
                <p style="margin-top: 0.5rem; font-size: 0.875rem;">⚠️ Save this key! You'll need it to login. We
                    recommend using a password manager.</p>
            </div>
        </div>
    </div>

    <!-- Notifications Modal -->
    <div class="notifications-modal" id="notificationsModal">
        <div class="notifications-modal-content">
            <div class="modal-header">
                <h2>Notifications</h2>
                <button class="close-modal" onclick="hideNotificationsModal()">&times;</button>
            </div>
            <div class="notifications-list" id="notificationsList">
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="close-modal" onclick="hideSettingsModal()">&times;</button>
            </div>

            <form class="upload-form" id="settingsForm">
                <div class="form-group">
                    <label>Relay Settings</label>
                    <div class="checkbox-group">
                        <input type="checkbox" id="useWotRelays" onchange="toggleWotRelays()">
                        <label for="useWotRelays">Use Web of Trust Relays</label>
                    </div>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                        Connect to Web of Trust relays for better spam filtering
                    </p>
                </div>

                <div class="form-group">
                    <label>Blossom Server Settings</label>
                    <div class="checkbox-group">
                        <input type="checkbox" id="usePremiumBlossom" onchange="togglePremiumBlossom()">
                        <label for="usePremiumBlossom">Premium Blossom Server (NostrMedia.com)</label>
                    </div>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                        Use NostrMedia.com if you are a subscribed user
                    </p>
                </div>

                <div class="form-group">
                    <label>Custom Blossom Servers</label>
                    <textarea id="customBlossomServers"
                        placeholder="Enter server URLs separated by commas&#10;Example: https://blossom.example.com, https://another.example.com"
                        rows="3"></textarea>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                        Add your own Blossom servers (comma-separated)
                    </p>
                </div>

                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="saveToNostr" checked>
                        <label for="saveToNostr">Save to Nostr</label>
                    </div>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                        Sync settings across all Plebs instances
                    </p>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button type="button" class="upload-btn" style="flex: 1;" onclick="saveSettings()">
                        Save Settings
                    </button>
                    <button type="button" class="upload-btn"
                        style="background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border);"
                        onclick="resetSettings()">
                        Reset to Defaults
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Upload Video</h2>
                <button class="close-modal" onclick="hideUploadModal()">&times;</button>
            </div>

            <form class="upload-form" id="uploadForm">
                <div class="form-group">
                    <label>Video File</label>
                    <div class="file-upload" id="fileUpload" onclick="document.getElementById('videoFile').click()">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" style="opacity: 0.5;">
                            <path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z" />
                        </svg>
                        <p>Click to select video or drag and drop</p>
                        <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">MP4, AVI, MOV,
                            etc (max 100MB)</p>
                    </div>
                    <input type="file" id="videoFile" accept="video/*" style="display: none;"
                        onchange="handleFileSelect(event)">
                </div>

                <div class="upload-progress" id="uploadProgress">
                    <p>Uploading to Blossom servers...</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <p id="uploadStatus" style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                    </p>
                </div>

                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="videoTitle" placeholder="Enter video title" required>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea id="videoDescription" placeholder="Tell viewers about your video" required></textarea>
                </div>

                <div class="form-group">
                    <label>Tags (comma separated)</label>
                    <input type="text" id="videoTags" placeholder="bitcoin, nostr, tutorial" required>
                </div>

                <div class="form-group">
                    <label>Thumbnail</label>
                    <input type="file" id="thumbnailFile" accept="image/*" required>
                </div>

                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="nsfwCheckbox">
                        <label for="nsfwCheckbox">Mark as NSFW (18+)</label>
                    </div>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                        Content containing adult material should be marked as NSFW
                    </p>
                </div>

                <button type="submit" class="upload-btn" style="margin-top: 1rem;">
                    Publish Video
                </button>
            </form>
        </div>
    </div>

    <!-- NSFW Warning Modal -->
    <div class="nsfw-modal" id="nsfwModal">
        <div class="nsfw-modal-content">
            <h2>Age Verification Required</h2>
            <p>This content is marked as NSFW (Not Safe For Work) and may contain adult material. You must be 18 years
                or older to view this content.</p>

            <div class="nsfw-modal-buttons">
                <button class="cancel" onclick="cancelNSFW()">Cancel</button>
                <button class="confirm" onclick="confirmNSFW()">I am 18+ years old</button>
            </div>

            <div class="nsfw-remember">
                <div class="checkbox-group">
                    <input type="checkbox" id="rememberNSFW">
                    <label for="rememberNSFW">Don't ask again (Remember my choice)</label>
                </div>
            </div>
        </div>
    </div>

    <!-- Community Warning Modal -->
    <div class="ratioed-modal" id="ratioedModal">
        <div class="ratioed-modal-content">
            <h2>Community Warning</h2>
            <p>This video has been flagged and/or heavily downvoted by the community. This might be due to:</p>
            <ul style="text-align: left; margin: 1rem 0;">
                <li>Inappropriate content not properly marked as NSFW</li>
                <li>New or suspicious user details</li>
                <li>Misleading or false information</li>
                <li>Spam or low-quality content</li>
                <li>Potentially harmful or illegal content</li>
            </ul>
            <p>Proceed with caution.</p>

            <div class="ratioed-modal-buttons">
                <button class="cancel" onclick="cancelRatioed()">Go Back</button>
                <button class="proceed" onclick="proceedRatioed()">View Anyway</button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="share-modal" id="shareModal">
        <div class="share-modal-content">
            <div class="modal-header">
                <h2>Share Video</h2>
                <button class="close-modal" onclick="hideShareModal()">&times;</button>
            </div>

            <p style="margin-bottom: 1rem;">Share this video with others:</p>

            <div class="share-url">
                <input type="text" id="shareUrlInput" readonly>
                <button class="copy-btn" onclick="copyShareUrl()">Copy</button>
            </div>

            <p id="copySuccess" style="color: var(--accent); margin-top: 0.5rem; display: none;">Copied to clipboard!
            </p>
        </div>
    </div>

    <!-- Nostr Tools -->
    <script src="https://unpkg.com/nostr-tools/lib/nostr.bundle.js"></script>

    <!-- Plebs Script -->
    <script src="app.js"></script>

    <!-- QR Code and WebLN for zaps -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://unpkg.com/webln@0.3.2/dist/webln.min.js"></script>

    <!-- GitHub Button Script -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
</body>

</html>